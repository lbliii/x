
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<meta content="Learn how to use the flexible Core API to train any deep learning model. This user guide walks you through plugging in your existing training code to get up and running." name="description" />

    <title>Core API User Guide &#8212; project-x 0.0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=362ab14a" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=dc820ae5"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'latest/model-dev-guide/apis-howto/api-core-ug';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="PyTorch API" href="api-pytorch-ug.html" />
    <link rel="prev" title="Training APIs" href="_index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    <p class="title logo__title">project-x 0.0.1 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../index.html">
                    Welcome to project-x’s documentation!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../example-solutions/_index.html">Examples</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../integrations/_index.html">Integrations</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../integrations/ecosystem/_index.html">Ecosystem Integration</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../integrations/notification/_index.html">Monitoring Experiment Through Webhooks</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../integrations/notification/zapier.html">Through Zapier</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../integrations/notification/slack.html">Through Slack</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../integrations/prometheus/_index.html">Configure Determined with Prometheus and Grafana</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../_index.html">Model Developer Guide</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="_index.html">Training APIs</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Core API User Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-pytorch-ug.html">PyTorch API</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-keras-ug.html">Keras API</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-estimator-ug.html">Estimator API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../batch-processing/_index.html">Torch Batch Processing API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../best-practices/_index.html">Best Practices</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../dtrain/_index.html">Distributed Training with Determined</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../dtrain/dtrain-introduction.html">Distributed Training Concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dtrain/dtrain-implement.html">Implementing Distributed Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dtrain/config-templates.html">Configuration Templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dtrain/reproducibility.html">Reproducibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dtrain/optimize-training.html">Optimizing Training</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../model-hub-library/_index.html">Model Hub Library</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../setup-cluster/_index.html">Setup</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../setup-cluster/deploy-cluster/_index.html">Set Up Determined</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../setup-cluster/deploy-cluster/aws/_index.html">Deploy on AWS</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/aws/aws-spot.html">Use Spot Instances</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/aws/dynamic-agents-aws.html">Deploy Determined with Dynamic Agents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/aws/install-on-aws.html">Install Determined</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../setup-cluster/deploy-cluster/gcp/_index.html">Deploy on GCP</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/gcp/dynamic-agents-gcp.html">Deploy Determined with Dynamic Agents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/gcp/install-gcp.html">Install Determined</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../setup-cluster/deploy-cluster/k8s/_index.html">Deploy on Kubernetes</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/k8s/custom-pod-specs.html">Customize a Pod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/k8s/helm-commands.html">Helm and Kubectl Command Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/k8s/install-on-kubernetes.html">Install Determined on Kubernetes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/k8s/k8s-dev-guide.html">Development Guide</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/k8s/setup-aks-cluster.html">Set up and Manage an Azure Kubernetes Service (AKS) Cluster</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/k8s/setup-eks-cluster.html">Set up and Manage an AWS Kubernetes (EKS) Cluster</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/k8s/setup-gke-cluster.html">Set up and Manage a Google Kubernetes Engine (GKE) Cluster</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/k8s/troubleshooting.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../setup-cluster/deploy-cluster/on-prem/_index.html">Deploy on Prem</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/on-prem/deploy.html">Install Determined Using <code class="docutils literal notranslate"><span class="pre">det</span> <span class="pre">deploy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/on-prem/docker.html">Install Determined Using Docker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/on-prem/homebrew.html">Install Determined Using Homebrew (macOS)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/on-prem/linux-packages.html">Install Determined Using Linux Packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/on-prem/requirements.html">Installation Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/on-prem/wsl.html">Install Determined Using Windows Subsystem for Linux (Windows)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../setup-cluster/deploy-cluster/slurm/_index.html">Deploy on Slurm/PBS</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/slurm/hpc-launching-architecture.html">HPC Launching Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/slurm/hpc-security-considerations.html">HPC Launcher Security Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/slurm/install-on-slurm.html">Install Determined on Slurm/PBS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/slurm/singularity.html">Provide a Container Image Cache</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/slurm/slurm-known-issues.html">Known Issues</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup-cluster/deploy-cluster/slurm/slurm-requirements.html">Installation Requirements</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../setup-cluster/security/_index.html">Security</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../setup-cluster/security/oauth.html">OAuth 2.0 Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../setup-cluster/security/oidc.html">OpenID Connect Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../setup-cluster/security/rbac.html">RBAC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../setup-cluster/security/saml.html">SAML Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../setup-cluster/security/scim.html">SCIM Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../setup-cluster/security/tls.html">Transport Layer Security</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/_index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/pytorch-mnist-local-qs.html">Run Your First Experiment in Determined</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/pytorch-mnist-tutorial.html">PyTorch MNIST Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/pytorch-porting-tutorial.html">PyTorch Porting Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/quickstart-mdldev.html">Quickstart for Model Developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/tf-mnist-tutorial.html">TensorFlow Keras Fashion MNIST Tutorial</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/latest/model-dev-guide/apis-howto/api-core-ug.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Core API User Guide</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> {your-title} </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectives">Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-get-the-tutorial-files-run-the-experiment">Step 1: Get the Tutorial Files &amp; Run the Experiment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-report-metrics">Step 2: Report Metrics</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-1-modify-the-main-loop">Step 2.1: Modify the Main Loop</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-2-modify-the-train-method">Step 2.2: Modify the Train Method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-3-modify-the-test-method">Step 2.3: Modify the Test Method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-4-run-the-experiment">Step 2.4: Run the Experiment</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-checkpointing">Step 3: Checkpointing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-1-save-checkpoints">Step 3.1: Save Checkpoints</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-2-continuations">Step 3.2: Continuations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-3-run-the-experiment">Step 3.3: Run the Experiment</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-hyperparameter-search">Step 4: Hyperparameter Search</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-1-run-the-experiment">Step 4.1: Run the Experiment</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-distributed-training">Step 5: Distributed Training</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-1-edit-your-experiment-configuration-file">Step 5.1: Edit Your Experiment Configuration File</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-2-modify-your-training-script">Step 5.2: Modify Your Training Script</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-3-run-the-experiment">Step 5.3: Run the Experiment</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#next-steps">Next Steps</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="core-api-user-guide">
<span id="core-getting-started"></span><h1>Core API User Guide<a class="headerlink" href="#core-api-user-guide" title="Permalink to this heading">#</a></h1>
<p>This guide will help you get up and running with the Core API.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Visit the API reference</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="xref std std-ref">core-reference</span></p></td>
</tr>
</tbody>
</table>
<p>In this user guide, we’ll show you how to adapt model training code to use the Core API. As an
example, we’ll be working with the PyTorch MNIST model.</p>
<section id="objectives">
<h2>Objectives<a class="headerlink" href="#objectives" title="Permalink to this heading">#</a></h2>
<p>These step-by-step instructions walk you through modifying a script for the purpose of performing
the following functions:</p>
<ul class="simple">
<li><p>Report metrics</p></li>
<li><p>Report checkpoints</p></li>
<li><p>Perform a hyperparameter search</p></li>
<li><p>Perform distributed training</p></li>
</ul>
<p>After completing the steps in this user guide, you will be able to:</p>
<ul class="simple">
<li><p>Understand the minimum requirements for running an experiment</p></li>
<li><p>Modify a script and an experiment configuration file</p></li>
<li><p>Understand how to convert model code</p></li>
<li><p>Use the Core API to train a model</p></li>
</ul>
</section>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading">#</a></h2>
<p><strong>Required</strong></p>
<ul class="simple">
<li><p>A Determined cluster</p></li>
</ul>
<p><strong>Recommended</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="../../tutorials/quickstart-mdldev.html#qs-mdldev"><span class="std std-ref">Quickstart for Model Developers</span></a></p></li>
</ul>
</section>
<section id="step-1-get-the-tutorial-files-run-the-experiment">
<h2>Step 1: Get the Tutorial Files &amp; Run the Experiment<a class="headerlink" href="#step-1-get-the-tutorial-files-run-the-experiment" title="Permalink to this heading">#</a></h2>
<p>To run an experiment, you need, at minimum, a script and an experiment configuration (YAML) file.</p>
<p>Create a new directory.</p>
<p>Access the tutorial files via the <code class="xref download docutils literal notranslate"><span class="pre">core_api_pytorch_mnist.tgz</span></code> download link or directly from the <a class="reference external" href="https://github.com/determined-ai/determined/tree/master/examples/tutorials/core_api_pytorch_mnist">Github repository</a>.
These scripts have already been modified to fit the steps outlined in this tutorial.</p>
<p>In this initial step, we’ll run our experiment using the <code class="docutils literal notranslate"><span class="pre">model_def.py</span></code> script and its
accompanying <code class="docutils literal notranslate"><span class="pre">const.yaml</span></code> experiment configuration file.</p>
<p>CD into the directory and run this command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>det<span class="w"> </span>e<span class="w"> </span>create<span class="w"> </span>const.yaml<span class="w"> </span>.<span class="w"> </span>-f
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">det</span> <span class="pre">e</span> <span class="pre">create</span> <span class="pre">const.yaml</span> <span class="pre">.</span> <span class="pre">-f</span></code> instructs Determined to follow the logs of the first trial that
is created as part of the experiment. The command will stay active and display the live output
from the logs of the first trial as it progresses.</p>
</div>
<p>Open the Determined WebUI by navigating to the master URL. One way to do this is to navigate to
<code class="docutils literal notranslate"><span class="pre">http://localhost:8080/</span></code>, accept the default Determined username, leave the password empty, and
click <strong>Sign In</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This tutorial provides instructions for running a local distributed training job. Your setup may
be different. For example, for instructions on how to run a remote distributed training job,
visit the <a class="reference internal" href="../../tutorials/quickstart-mdldev.html#qs-mdldev"><span class="std std-ref">Quickstart for Model Developers</span></a>.</p>
</div>
<p>In the WebUI, select your experiment. You’ll notice the tabs do not yet contain any information. In
the next section, we’ll report training and validation metrics.</p>
</section>
<section id="step-2-report-metrics">
<h2>Step 2: Report Metrics<a class="headerlink" href="#step-2-report-metrics" title="Permalink to this heading">#</a></h2>
<p>To report training and validation metrics to the Determined master, we’ll add a few lines of code to
our script. More specifically, we’ll create a <code class="xref py py-class docutils literal notranslate"><span class="pre">Context</span></code> object to allow
interaction with the master. Then, we’ll pass the <code class="docutils literal notranslate"><span class="pre">core_context</span></code> as an argument into <code class="docutils literal notranslate"><span class="pre">main()</span></code>,
<code class="docutils literal notranslate"><span class="pre">train()</span></code>, and <code class="docutils literal notranslate"><span class="pre">test()</span></code> and modify the function headers accordingly.</p>
<p>To run our experiment, we’ll use the <code class="docutils literal notranslate"><span class="pre">model_def_metrics.py</span></code> script and its accompanying
<code class="docutils literal notranslate"><span class="pre">metrics.yaml</span></code> experiment configuration file.</p>
<p>Begin by importing Determined:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">determined</span> <span class="k">as</span> <span class="nn">det</span>
</pre></div>
</div>
<section id="step-2-1-modify-the-main-loop">
<h3>Step 2.1: Modify the Main Loop<a class="headerlink" href="#step-2-1-modify-the-main-loop" title="Permalink to this heading">#</a></h3>
<p>We’ll need a <code class="xref py py-class docutils literal notranslate"><span class="pre">Context</span></code> object for interacting with the master. To accomplish
this, we’ll modify the <code class="docutils literal notranslate"><span class="pre">__main__</span></code> loop to include <code class="docutils literal notranslate"><span class="pre">core_context</span></code>:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Refer to the <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">&quot;__main__&quot;:</span></code> block in <code class="docutils literal notranslate"><span class="pre">model_def_metrics.py</span></code></p>
</div>
</section>
<section id="step-2-2-modify-the-train-method">
<h3>Step 2.2: Modify the Train Method<a class="headerlink" href="#step-2-2-modify-the-train-method" title="Permalink to this heading">#</a></h3>
<p>Use <code class="docutils literal notranslate"><span class="pre">core_context.train</span></code> to report training and validation metrics.</p>
<ol class="arabic simple">
<li><p>Begin by importing the <code class="docutils literal notranslate"><span class="pre">determined</span></code> module:</p></li>
</ol>
<p>and <code class="docutils literal notranslate"><span class="pre">core_context.train.report_validation_metrics()</span></code>:</p>
</section>
<section id="step-2-3-modify-the-test-method">
<h3>Step 2.3: Modify the Test Method<a class="headerlink" href="#step-2-3-modify-the-test-method" title="Permalink to this heading">#</a></h3>
<p>Modify the <code class="docutils literal notranslate"><span class="pre">test()</span></code> function header to include <code class="docutils literal notranslate"><span class="pre">args</span></code> and other elements you’ll need during the
evaluation loop. The <code class="docutils literal notranslate"><span class="pre">args</span></code> variable lets you pass configuration settings such as batch size and
learning rate. In addition, pass the newly created <code class="docutils literal notranslate"><span class="pre">core_context</span></code> into both <code class="docutils literal notranslate"><span class="pre">train()</span></code> and
<code class="docutils literal notranslate"><span class="pre">test()</span></code>. Passing <code class="docutils literal notranslate"><span class="pre">core_context</span></code> enables reporting of metrics to the Determined master.</p>
<p>Create a <code class="docutils literal notranslate"><span class="pre">steps_completed</span></code> variable to plot metrics on a graph in the WebUI:</p>
</section>
<section id="step-2-4-run-the-experiment">
<h3>Step 2.4: Run the Experiment<a class="headerlink" href="#step-2-4-run-the-experiment" title="Permalink to this heading">#</a></h3>
<p>Run the following command to run the experiment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">det</span> <span class="n">e</span> <span class="n">create</span> <span class="n">metrics</span><span class="o">.</span><span class="n">yaml</span> <span class="o">.</span>
</pre></div>
</div>
<p>Open the Determined WebUI again and navigate to the <strong>Overview</strong> tab.</p>
<p>The WebUI now displays metrics. In this step, you learned how to add a few new lines of code in
order to report training and validation metrics to the Determined master. Next, we’ll modify our
script to report checkpoints.</p>
</section>
</section>
<section id="step-3-checkpointing">
<h2>Step 3: Checkpointing<a class="headerlink" href="#step-3-checkpointing" title="Permalink to this heading">#</a></h2>
<p>Checkpointing periodically during training and reporting the checkpoints to the master gives us the
ability to stop and restart training. In this section, we’ll modify our script for the purpose of
checkpointing.</p>
<p>In this step, we’ll run our experiment using the <code class="docutils literal notranslate"><span class="pre">model_def_checkpoints.py</span></code> script and its
accompanying <code class="docutils literal notranslate"><span class="pre">checkpoints.yaml</span></code> experiment configuration file.</p>
<section id="step-3-1-save-checkpoints">
<h3>Step 3.1: Save Checkpoints<a class="headerlink" href="#step-3-1-save-checkpoints" title="Permalink to this heading">#</a></h3>
<p>To save checkpoints, add the <code class="docutils literal notranslate"><span class="pre">store_path</span></code> function to your script:</p>
</section>
<section id="step-3-2-continuations">
<h3>Step 3.2: Continuations<a class="headerlink" href="#step-3-2-continuations" title="Permalink to this heading">#</a></h3>
<p>There are two types of continuations: pausing and reactivating training using the WebUI or clicking
<strong>Continue Trial</strong> after the experiment completes.</p>
<p>These two types of continuations have different behaviors. While you always want to preserve the
model’s state, you do not always want to preserve the batch index. When you pause and reactivate you
want training to continue from the same batch index, but when starting a fresh experiment you want
training to start with a fresh batch index. You can save the trial ID in the checkpoint and use it
to distinguish the two types of continuations.</p>
<p>To distinguish between the two types of continuations, you can save the trial ID in the checkpoint.</p>
<p><strong>Enable Pausing and Resuming an Experiment</strong></p>
<p>To enable pausing an experiment, enable preemption:</p>
<p>Define a load_state function for restarting model training from existing checkpoint:</p>
<p>If checkpoint exists, load it and assign it to model state prior to resuming training:</p>
<p><strong>Enable Continuing the Trial</strong></p>
<p>To enable continuing the trial after the experiment completes, save the trial ID. One way to do this
is to load the checkpoint and save the checkpoint in a file in the checkpoint directory.</p>
<p>Open the <code class="docutils literal notranslate"><span class="pre">checkpoint.pt</span></code> file in binary mode and compare <code class="docutils literal notranslate"><span class="pre">ckpt_trial_id</span></code> with the current
<code class="docutils literal notranslate"><span class="pre">trial_id</span></code>:</p>
<p>Save the checkpoint in the <code class="docutils literal notranslate"><span class="pre">checkpoint.pt</span></code> file:</p>
<p>Detect when the experiment is paused by the WebUI:</p>
</section>
<section id="step-3-3-run-the-experiment">
<h3>Step 3.3: Run the Experiment<a class="headerlink" href="#step-3-3-run-the-experiment" title="Permalink to this heading">#</a></h3>
<p>Run the following command to run the experiment:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>det<span class="w"> </span>e<span class="w"> </span>create<span class="w"> </span>checkpoints.yaml<span class="w"> </span>.<span class="w"> </span>-f
</pre></div>
</div>
<p>In the Determined WebUI, nagivate to the <strong>Checkpoints</strong> tab.</p>
<p>Checkpoints are saved and deleted according to the default
<span class="xref std std-ref">experiment-config-checkpoint-policy</span>. You can modify the checkpoint policy in the experiment
configuration file.</p>
</section>
</section>
<section id="step-4-hyperparameter-search">
<h2>Step 4: Hyperparameter Search<a class="headerlink" href="#step-4-hyperparameter-search" title="Permalink to this heading">#</a></h2>
<p>With the Core API you can run advanced hyperparameter searches with arbitrary training code. The
hyperparameter search logic is in the master, which coordinates many different Trials. Each trial
runs a train-validate-report loop:</p>
<table class="table">
<tbody>
<tr class="row-odd"><td><p>Train</p></td>
<td><p>Train until a point chosen by the hyperparameter search algorithm and
obtained via the Core API.  The length of training is absolute, so you
have to keep track of how much you have already trained to know how much
more to train.</p></td>
</tr>
<tr class="row-even"><td><p>Validate</p></td>
<td><p>Validate your model to obtain the metric you configured in the
<code class="docutils literal notranslate"><span class="pre">searcher.metric</span></code> field of your experiment config.</p></td>
</tr>
<tr class="row-odd"><td><p>Report</p></td>
<td><p>Use the Core API to report results to the master.</p></td>
</tr>
</tbody>
</table>
<p>To perform a hyperparameter search, we’ll update our script to define the hyperparameter search
settings we want to use for our experiment. More specifically, we’ll need to define the following
settings in our experiment configuration file:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name:</span></code> <code class="docutils literal notranslate"><span class="pre">adaptive_asha</span></code> (name of our searcher. For all options, visit <span class="xref std std-doc">Search Methods</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">metric</span></code>: <code class="docutils literal notranslate"><span class="pre">test_loss</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">smaller_is_better</span></code>: <code class="docutils literal notranslate"><span class="pre">True</span></code> (This is equivalent to minimization vs. maximization of
objective.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_trials</span></code>: 500 (This is the maximum number of trials the searcher should run.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_length</span></code>: 20 epochs (The max length of a trial. For more information, visit Adaptive ASHA
in the <span class="xref std std-doc">Experiment Configuration Reference</span>.</p></li>
</ul>
<p>In addition, we also need to define the hyperparameters themselves. Adaptive ASHA will pick values
between the <code class="docutils literal notranslate"><span class="pre">minval</span></code> and <code class="docutils literal notranslate"><span class="pre">maxval</span></code> for each hyperparameter for each trial.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To see early stopping in action, try setting <code class="docutils literal notranslate"><span class="pre">max_trials</span></code> to over 500 and playing around with
the hyperparameter search values.</p>
</div>
<p>In this step, we’ll run our experiment using the <code class="docutils literal notranslate"><span class="pre">model_def_adaptive.py</span></code> script and its
accompanying <code class="docutils literal notranslate"><span class="pre">adaptive.yaml</span></code> experiment configuration file.</p>
<p>Begin by accessing the hyperparameters in your code:</p>
<p>Then, pass the hyperparameters into your model and optimizer:</p>
<p>Ensure your model is set to use the selected values on a per-trial basis rather than your previously
hardcoded values:</p>
<section id="step-4-1-run-the-experiment">
<h3>Step 4.1: Run the Experiment<a class="headerlink" href="#step-4-1-run-the-experiment" title="Permalink to this heading">#</a></h3>
<p>Run the following command to run the experiment:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>det<span class="w"> </span>e<span class="w"> </span>create<span class="w"> </span>adaptive.yaml<span class="w"> </span>.
</pre></div>
</div>
<p>In the Determined WebUI, navigate to the <strong>Hyperparameters</strong> tab.</p>
<p>You should see a graph in the WebUI that displays the various trials initiated by the Adaptive ASHA
hyperparameter search algorithm.</p>
</section>
</section>
<section id="step-5-distributed-training">
<h2>Step 5: Distributed Training<a class="headerlink" href="#step-5-distributed-training" title="Permalink to this heading">#</a></h2>
<p>The Core API has special features for running distributed training. Some of the more important
features are:</p>
<ul class="simple">
<li><p>Access to all IP addresses of every node in the Trial (through the ClusterInfo API).</p></li>
<li><p>Communication primitives such as <code class="xref py py-meth docutils literal notranslate"><span class="pre">allgather()</span></code>,
<code class="xref py py-meth docutils literal notranslate"><span class="pre">gather()</span></code>, and
<code class="xref py py-meth docutils literal notranslate"><span class="pre">broadcast()</span></code> to give you out-of-the-box coordination
between workers.</p></li>
<li><p>Since many distributed training frameworks expect all workers in training to operate in-step, the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">should_preempt()</span></code> call is automatically synchronized across
workers so that all workers decide to preempt or continue as a unit.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Launchers</p>
<p>Typically, you do not have to write your own launcher. Determined provides launchers for Horovod,
torch.distributed, and DeepSpeed. For more information about launcher options, visit
<a class="reference internal" href="../submit-experiment.html#experiments"><span class="std std-ref">Submit Experiment</span></a>.</p>
</div>
<p>In this example, we’ll be using PyTorch’s DistributedDataParallel. We’ll also need to make specific
changes to our configuration experiment file.</p>
<p>In this step, we’ll run our experiment using the <code class="docutils literal notranslate"><span class="pre">model_def_distributed.py</span></code> script and its
accompanying <code class="docutils literal notranslate"><span class="pre">distributed.yaml</span></code> experiment configuration file.</p>
<section id="step-5-1-edit-your-experiment-configuration-file">
<h3>Step 5.1: Edit Your Experiment Configuration File<a class="headerlink" href="#step-5-1-edit-your-experiment-configuration-file" title="Permalink to this heading">#</a></h3>
<p>Edit your experiment configuration file to point to a launch script:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">entrypoint</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">   </span><span class="no">python3 -m determined.launch.torch_distributed</span>
<span class="w">   </span><span class="no">python3 model_def_distributed.py</span>
</pre></div>
</div>
<p>and, set <code class="docutils literal notranslate"><span class="pre">slots_per_trial</span></code> (under <code class="docutils literal notranslate"><span class="pre">resources</span></code>) to the number of GPUs you want to distribute the
training across:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">resources</span><span class="p">:</span>
<span class="w">  </span><span class="nt">slots_per_trial</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
</pre></div>
</div>
</section>
<section id="step-5-2-modify-your-training-script">
<h3>Step 5.2: Modify Your Training Script<a class="headerlink" href="#step-5-2-modify-your-training-script" title="Permalink to this heading">#</a></h3>
<p>Add a few more imports to your training script:</p>
<p>Initialize a process group using <code class="docutils literal notranslate"><span class="pre">torch</span></code>. After initializing a process group, initialize a
Determined distributed context using <code class="docutils literal notranslate"><span class="pre">from_torch_distributed</span></code>:</p>
<p>In <code class="docutils literal notranslate"><span class="pre">main</span></code>, set your selected device to the device with index of <code class="docutils literal notranslate"><span class="pre">local_rank</span></code>. This is a best
practice even if you only have a single GPU-per-node setup:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Refer to the <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">use_cuda:</span></code> block in <code class="docutils literal notranslate"><span class="pre">model_def_distributed.py</span></code></p>
</div>
<p>Shard the data into <code class="docutils literal notranslate"><span class="pre">num_replicas</span></code> non-overlapping parts. <code class="docutils literal notranslate"><span class="pre">num_replicas</span></code> is equal to
<code class="docutils literal notranslate"><span class="pre">core_context.distributed.size</span></code>, or the number of slots:</p>
<p>Wrap your model with torch’s DistributedDataParallel:</p>
<p>Finally, at each place in the code where you upload checkpoints, report training metrics, or report
progress to the master, make sure this is done only on rank 0, e.g.,:</p>
</section>
<section id="step-5-3-run-the-experiment">
<h3>Step 5.3: Run the Experiment<a class="headerlink" href="#step-5-3-run-the-experiment" title="Permalink to this heading">#</a></h3>
<p>Run the following command to run the experiment:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>det<span class="w"> </span>e<span class="w"> </span>create<span class="w"> </span>distributed.yaml<span class="w"> </span>.
</pre></div>
</div>
<p>In the Determined WebUI, navigate to the <strong>Cluster</strong> pane.</p>
<p>You should be able to see multiple slots active corresponding to the value you set for
<code class="docutils literal notranslate"><span class="pre">slots_per_trial</span></code> you set in <code class="docutils literal notranslate"><span class="pre">distributed.yaml</span></code>, as well as logs appearing from multiple ranks.</p>
</section>
</section>
<section id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Permalink to this heading">#</a></h2>
<p>In this user guide, you learned how to use the Core API to integrate a model into Determined. You
also saw how to modify a training script and use the appropriate configuration file to report
metrics and checkpointing, perform a hyperparameter search, and run distributed training.</p>
</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="_index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Training APIs</p>
      </div>
    </a>
    <a class="right-next"
       href="api-pytorch-ug.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">PyTorch API</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> {your-title}
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectives">Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-get-the-tutorial-files-run-the-experiment">Step 1: Get the Tutorial Files &amp; Run the Experiment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-report-metrics">Step 2: Report Metrics</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-1-modify-the-main-loop">Step 2.1: Modify the Main Loop</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-2-modify-the-train-method">Step 2.2: Modify the Train Method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-3-modify-the-test-method">Step 2.3: Modify the Test Method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-4-run-the-experiment">Step 2.4: Run the Experiment</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-checkpointing">Step 3: Checkpointing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-1-save-checkpoints">Step 3.1: Save Checkpoints</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-2-continuations">Step 3.2: Continuations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-3-run-the-experiment">Step 3.3: Run the Experiment</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-hyperparameter-search">Step 4: Hyperparameter Search</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-1-run-the-experiment">Step 4.1: Run the Experiment</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-distributed-training">Step 5: Distributed Training</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-1-edit-your-experiment-configuration-file">Step 5.1: Edit Your Experiment Configuration File</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-2-modify-your-training-script">Step 5.2: Modify Your Training Script</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-3-run-the-experiment">Step 5.3: Run the Experiment</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#next-steps">Next Steps</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By lb
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023, lb.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>